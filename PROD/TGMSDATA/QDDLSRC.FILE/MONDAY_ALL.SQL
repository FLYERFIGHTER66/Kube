CREATE OR REPLACE VIEW Mondays_ALL AS

SELECT  -- VARIOUS DATE FORMATS
  DATE(SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),1,2) ||'/'||
       SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),3,2) ||'/'||trim(char(CLCENT))||
       SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),5,2)) AS DATEFLD
, DATE(SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),1,2) ||'/'||
       SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),3,2) ||'/'||trim(char(CLCENT))||
       SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),5,2)) AS MONDAY_DATE
,  CHAR(SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),1,2) ||'/'||
       SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),3,2) ||'/'||trim(char(CLCENT))||
       SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),5,2)) AS MONDAY_TEXT

, CLDATE                                            AS MONDAY6MDY
, CLCYMD                                            AS CYMD7
, CLCYMD + 19000000                                 AS MONDAY8YMD
-- YEAR VALUES
, CLCENT                                            AS CENTURY
, CLYEAR                                            AS YEAR2
, (CLCENT-19)*100+CLYEAR                            AS YEAR3
, (CLCENT*100)+CLYEAR                               AS YEAR4
, int('20'||RIGHT(TRIM(CHAR(CLDATE)),2))            AS CAL_YEAR_4

-- MONTH VALUES
, INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))    AS MONTH_NUMBER
, CASE
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=1 THEN 'JANUARY'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=2 THEN 'FEBRUARY'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=3 THEN 'MARCH'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=4 THEN 'APRIL'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=5 THEN 'MAY'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=6 THEN 'JUNE'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=7 THEN 'JULY'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=8 THEN 'AUGUST'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=9 THEN 'SEPTEMBER'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=10 THEN 'OCTOBER'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=11 THEN 'NOVEMBER'
    WHEN INT(LEFT(RIGHT('0'||TRIM(CHAR(CLDATE)),6),2))=12 THEN 'DECEMBER'
  END  AS MONTH_NAME

-- WEEK VALUES
, CLWEEK                                            AS WEEK_NUMBER
, INT(RIGHT(TRIM(CHAR(CLDATE)),2)||
     RIGHT(TRIM('0'||CHAR(CLWEEK)),2)) AS WEEK_4
, INT('1'||RIGHT(TRIM(CHAR(CLDATE)),2)||
     RIGHT(TRIM('0'||CHAR(CLWEEK)),2)) AS WEEK_5
, INT('20'||RIGHT(TRIM(CHAR(CLDATE)),2)||
     RIGHT(TRIM('0'||CHAR(CLWEEK)),2)) AS WEEK_6

-- DAY VALUES
,     right(trim(char(CLCYMD)),2)                   AS DOTM
, int(right(trim(char(CLCYMD)),2))                  AS DOTM#
, CL#Y                                              AS DOTW
, CASE
    WHEN CL#Y = 1 THEN 'MONDAY'
    WHEN CL#Y = 2 THEN 'TUESDAY'
    WHEN CL#Y = 3 THEN 'WEDNESDAY'
    WHEN CL#Y = 4 THEN 'THURSDAY'
    WHEN CL#Y = 5 THEN 'FRIDAY'
    WHEN CL#Y = 6 THEN 'SATURDAY'
    WHEN CL#Y = 7 THEN 'SUNDAY'
  END                                               AS DOTW_NAME

-- PERIOD VALUES
,INT(     RIGHT(TRIM(CHAR(CLDATE)),2)
  ||SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),1,2)) AS PERIOD_4
,INT('1'||RIGHT(TRIM(CHAR(CLDATE)),2)
  ||SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),1,2)) AS PERIOD_5
,INT('20'||RIGHT(TRIM(CHAR(CLDATE)),2)
  ||SUBSTR(RIGHT('000'||TRIM(CHAR(CLDATE)),6),1,2)) AS PERIOD_6

, RIGHT(TRIM(CHAR(CLDATE)),2)||
  CASE
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 39999 THEN 'Q1'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 69999 THEN 'Q2'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 99999 THEN 'Q3'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) >  99999 THEN 'Q4'
  END  AS QUARTER_2
, '1'||RIGHT(TRIM(CHAR(CLDATE)),2)||
  CASE
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 39999 THEN 'Q1'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 69999 THEN 'Q2'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 99999 THEN 'Q3'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) >  99999 THEN 'Q4'
  END  AS QUARTER_3
, '20'||RIGHT(TRIM(CHAR(CLDATE)),2)||
  CASE
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 39999 THEN 'Q1'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 69999 THEN 'Q2'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 99999 THEN 'Q3'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) >  99999 THEN 'Q4'
  END  AS QUARTER_4
, 'NY20' || CASE
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <=  29999
        THEN RIGHT(TRIM(CHAR(CLDATE)),2)||'Q1'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <=  59999
        THEN RIGHT(TRIM(CHAR(CLDATE)),2)||'Q2'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <=  89999
        THEN RIGHT(TRIM(CHAR(CLDATE)),2)||'Q3'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) <= 119999
        THEN RIGHT(TRIM(CHAR(CLDATE)),2)||'Q4'
    WHEN INT(RIGHT('0'||TRIM(CHAR(CLDATE)),6)) >  119999
        THEN RIGHT(TRIM(CHAR(CLDATE+1)),2)||'Q1'
  END  AS NY_QUARTER_4

FROM FCALEN

WHERE CLCENT = 20
  and CL#Y = 1;
